> In this project, I queried a dataset for a digital media store

> Analysis

> 1. Find the top 5 most popular genres by track count.

SELECT g.Name AS Genre, COUNT(t.TrackId) AS NumberOfTracks
FROM chinook.genres g
INNER JOIN chinook.tracks t 
ON g.GenreId = t.GenreId
GROUP BY g.Name
ORDER BY NumberOfTracks DESC
LIMIT 5;

> 2. Find the total revenue generated by each employee.

SELECT e.LastName || ', ' || e.FirstName AS Employee, ROUND(SUM(ii.UnitPrice * ii.Quantity),2) AS TotalRevenue
FROM chinook.employees e
INNER JOIN chinook.customers c 
ON e.EmployeeId = c.SupportRepId
INNER JOIN chinook.invoices i 
ON c.CustomerId = i.CustomerId
INNER JOIN chinook.invoice_items ii 
ON i.InvoiceId = ii.InvoiceId
GROUP BY Employee
ORDER BY TotalRevenue DESC;

> 3. Find the top 10 artists by number of albums.

SELECT ar.Name AS Artist, COUNT(al.AlbumId) AS NumberOfAlbums
FROM chinook.artists ar
INNER JOIN chinook.albums al ON ar.ArtistId = al.ArtistId
GROUP BY ar.Name
ORDER BY NumberOfAlbums DESC
LIMIT 10;

> 4. Show Customers (their full names, customer ID, and country) who are not in the US. 

SELECT  FirstName || ' ' || LastName AS FullName, CustomerId, Country
FROM chinook.customers
WHERE Country <> 'USA';

> 5. Show only the Customers from Brazil.

SELECT FirstName || ' ' || LastName AS FullName, CustomerId, Country
FROM chinook.customers
WHERE Country = 'Brazil';

> 6. Find the Invoices of customers who are from Brazil. The resulting table should show the customer's full name, Invoice ID, Date of the invoice, and billing country.

SELECT  c.FirstName || ' ' || c.LastName AS FullName, i.InvoiceId,  i.InvoiceDate, i.BillingCountry
FROM chinook.customers c
INNER JOIN chinook.invoices i ON c.CustomerId = i.CustomerId
WHERE c.Country = 'Brazil';

> 7. Show the Employees who are Sales Agents.

SELECT  FirstName || ' ' || LastName AS FullName,  Title
FROM chinook.employees
WHERE Title = 'Sales Support Agent';

> 8. Find a unique/distinct list of billing countries from the Invoice table.

SELECT DISTINCT BillingCountry
FROM chinook.invoices;

> 9. Provide a query that shows the invoices associated with each sales agent. The resulting table should include the Sales Agent's full name.

SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, i.InvoiceId
FROM chinook.employees e
INNER JOIN chinook.customers c ON e.EmployeeId = c.SupportRepId
INNER JOIN chinook.invoices i ON c.CustomerId = i.CustomerId;

> 10. Show the Invoice Total, Customer name, Country, and Sales Agent name for all invoices and customers.

SELECT i.Total AS InvoiceTotal, c.FirstName || ' ' || c.LastName AS CustomerName, c.Country, e.FirstName || ' ' || e.LastName AS SalesAgent
FROM chinook.invoices i
INNER JOIN chinook.customers c ON i.CustomerId = c.CustomerId
INNER JOIN chinook.employees e ON c.SupportRepId = e.EmployeeId;

> 11. How many Invoices were there in 2009?

SELECT COUNT(*) AS NumberOfInvoices
FROM chinook.invoices
WHERE strftime('%Y', InvoiceDate) = '2009';

> 12. What are the total sales for 2009?

SELECT SUM(Total) AS TotalSales
FROM chinook.invoices
WHERE strftime('%Y', InvoiceDate) = '2009';

> 13. Write a query that includes the purchased track name with each invoice line ID.

SELECT ii.InvoiceLineId, t.Name AS TrackName
FROM chinook.invoice_items ii
INNER JOIN chinook.tracks t ON ii.TrackId = t.TrackId;

> 14. Write a query that includes the purchased track name AND artist name with each invoice line ID.

SELECT ii.InvoiceLineId, t.Name AS TrackName, ar.Name AS ArtistName
FROM chinook.invoice_items ii
INNER JOIN chinook.tracks t ON ii.TrackId = t.TrackId
INNER JOIN chinook.albums al ON t.AlbumId = al.AlbumId
INNER JOIN chinook.artists ar ON al.ArtistId = ar.ArtistId;

> 15. Provide a query that shows all the Tracks, and include the Album name, Media type, and Genre.

SELECT t.Name AS TrackName, al.Title AS AlbumName, mt.Name AS MediaType, g.Name AS Genre
FROM chinook.tracks t
INNER JOIN chinook.albums al ON t.AlbumId = al.AlbumId
INNER JOIN chinook.media_types mt ON t.MediaTypeId = mt.MediaTypeId
INNER JOIN chinook.genres g ON t.GenreId = g.GenreId;

> 16. Show the total sales made by each sales agent.

SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, ROUND(SUM(i.Total),2) AS TotalSales
FROM chinook.employees e
INNER JOIN chinook.customers c ON e.EmployeeId = c.SupportRepId
INNER JOIN chinook.invoices i ON c.CustomerId = i.CustomerId
GROUP BY SalesAgent;

> 17. Which sales agent made the most dollars in sales in 2009?

SELECT e.FirstName || ' ' || e.LastName AS SalesAgent, ROUND(SUM(i.Total),2) AS TotalSales
FROM chinook.employees e
INNER JOIN chinook.customers c ON e.EmployeeId = c.SupportRepId
INNER JOIN chinook.invoices i ON c.CustomerId = i.CustomerId
WHERE strftime('%Y', i.InvoiceDate) = '2009'
GROUP BY SalesAgent
ORDER BY TotalSales DESC
LIMIT 1;

